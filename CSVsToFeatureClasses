import arcpy

arcpy.env.overwriteOutput = True #allows code to be rerun and overwrite the output files when needed

#input folder where csvs are stored
arcpy.env.workspace = r"E:\0Val_Local\Phase2DataCleaning\1_RawData_Fixed\OSPR"

#list all csvs in the input folder path so can iterate through them
csvs = arcpy.ListTables()

#spatial reference is GCS WGS 1984
spatref="GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;-100000 10000;-100000 10000;8.98315284119522E-09;0.001;0.001;IsHighPrecision"

#output file geodatabase for new feature classes
outpath = "E:/0Val_Local/Phase2DataCleaning/2_PointsData_Fixed/OSPR.gdb/"

#create event layer then create feature class from CSV - keep name without .csv extension

for csv in csvs:
    if csv.startswith('MarkMartell'):
        print csv
        eventlayer = arcpy.MakeXYEventLayer_management(csv,'long','lat',None,spatref)
        newname = csv[:-4]
        arcpy.CopyFeatures_management(eventlayer,outpath+newname)

print 'code completed'
arcpy.env.workspace = outpath
fcs = arcpy.ListFeatureClasses()

if len(csvs) == len(fcs):
    print 'yes, same amount of fcs as csvs'
else:
    print 'no, not as many fcs as csvs'

print 'csvs:'+str(len(csvs))
print 'fcs:'+str(len(fcs))
